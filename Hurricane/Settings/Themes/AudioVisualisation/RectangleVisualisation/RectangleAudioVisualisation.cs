using System.Windows;
using System.Windows.Media;
using Hurricane.PluginAPI.AudioVisualisation;

namespace Hurricane.Settings.Themes.AudioVisualisation.RectangleVisualisation
{
    public class RectangleAudioVisualisation : AudioVisualisationBase
    {
        private IAudioVisualisationPlugin _loadedPlugin;
        public override IAudioVisualisationPlugin Visualisation
        {
            get { return _loadedPlugin ?? (_loadedPlugin = new AudioVisualisationPlugin()); }
        }

        public override string Name
        {
            get { return Application.Current.Resources["Rectangles"].ToString(); }
        }

        public class AudioVisualisationPlugin : IAudioVisualisationPlugin
        {
            private IAudioVisualisation _advancedAudioVisualisation;
            public IAudioVisualisation AdvancedWindowVisualisation
            {
                get
                {
                    return _advancedAudioVisualisation ??
                           (_advancedAudioVisualisation = new AdvancedWindowAudioVisualisation());
                }
            }

            private IAudioVisualisation _smartWindowAudioVisualisation;
            public IAudioVisualisation SmartWindowVisualisation
            {
                get
                {
                    return _smartWindowAudioVisualisation ??
                           (_smartWindowAudioVisualisation = new SmartWindowAudioVisualisation());
                }
            }

            public string Creator
            {
                get { return "Akaline"; }
            }

            private GeometryGroup _thumbnail;
            public GeometryGroup Thumbnail
            {
                get
                {
                    if (_thumbnail == null)
                    {
                        var values = new[]
                        {
                            "F1 M 6.367,16.715 L 0.974,16.715 C 0.436,16.715 0.000,17.151 0.000,17.689 C 0.000,18.226 0.436,18.662 0.974,18.662 L 6.367,18.662 C 6.905,18.662 7.341,18.226 7.341,17.689 C 7.341,17.151 6.905,16.715 6.367,16.715 Z",
                            "F1 M 6.367,13.372 L 0.974,13.372 C 0.436,13.372 0.000,13.808 0.000,14.346 C 0.000,14.883 0.436,15.319 0.974,15.319 L 6.367,15.319 C 6.905,15.319 7.341,14.883 7.341,14.346 C 7.341,13.808 6.905,13.372 6.367,13.372 Z",
                            "F1 M 6.367,10.029 L 0.974,10.029 C 0.436,10.029 0.000,10.465 0.000,11.003 C 0.000,11.540 0.436,11.976 0.974,11.976 L 6.367,11.976 C 6.905,11.976 7.341,11.540 7.341,11.003 C 7.341,10.465 6.905,10.029 6.367,10.029 Z",
                            "F1 M 6.367,20.023 L 0.974,20.023 C 0.436,20.023 0.000,20.459 0.000,20.997 C 0.000,21.535 0.436,21.970 0.974,21.970 L 6.367,21.970 C 6.905,21.970 7.341,21.535 7.341,20.997 C 7.341,20.459 6.905,20.023 6.367,20.023 Z",
                            "F1 M 14.587,16.715 L 9.193,16.715 C 8.656,16.715 8.220,17.151 8.220,17.689 C 8.220,18.226 8.656,18.662 9.193,18.662 L 14.587,18.662 C 15.125,18.662 15.561,18.226 15.561,17.689 C 15.561,17.151 15.125,16.715 14.587,16.715 Z",
                            "F1 M 14.587,13.372 L 9.193,13.372 C 8.656,13.372 8.220,13.808 8.220,14.346 C 8.220,14.883 8.656,15.319 9.193,15.319 L 14.587,15.319 C 15.125,15.319 15.561,14.883 15.561,14.346 C 15.561,13.808 15.125,13.372 14.587,13.372 Z",
                            "F1 M 14.587,6.686 L 9.193,6.686 C 8.656,6.686 8.220,7.122 8.220,7.660 C 8.220,8.197 8.656,8.633 9.193,8.633 L 14.587,8.633 C 15.125,8.633 15.561,8.197 15.561,7.660 C 15.561,7.122 15.125,6.686 14.587,6.686 Z",
                            "F1 M 14.587,3.343 L 9.193,3.343 C 8.656,3.343 8.220,3.779 8.220,4.316 C 8.220,4.854 8.656,5.290 9.193,5.290 L 14.587,5.290 C 15.125,5.290 15.561,4.854 15.561,4.316 C 15.561,3.779 15.125,3.343 14.587,3.343 Z",
                            "F1 M 14.587,0.000 L 9.193,0.000 C 8.656,0.000 8.220,0.436 8.220,0.974 C 8.220,1.511 8.656,1.947 9.193,1.947 L 14.587,1.947 C 15.125,1.947 15.561,1.511 15.561,0.974 C 15.561,0.436 15.125,0.000 14.587,0.000 Z",
                            "F1 M 14.587,10.029 L 9.193,10.029 C 8.656,10.029 8.220,10.465 8.220,11.003 C 8.220,11.540 8.656,11.976 9.193,11.976 L 14.587,11.976 C 15.125,11.976 15.561,11.540 15.561,11.003 C 15.561,10.465 15.125,10.029 14.587,10.029 Z",
                            "F1 M 14.587,20.023 L 9.193,20.023 C 8.656,20.023 8.220,20.459 8.220,20.997 C 8.220,21.535 8.656,21.970 9.193,21.970 L 14.587,21.970 C 15.125,21.970 15.561,21.535 15.561,20.997 C 15.561,20.459 15.125,20.023 14.587,20.023 Z",
                            "F1 M 22.807,16.715 L 17.413,16.715 C 16.875,16.715 16.440,17.151 16.440,17.689 C 16.440,18.226 16.875,18.662 17.413,18.662 L 22.807,18.662 C 23.345,18.662 23.780,18.226 23.780,17.689 C 23.780,17.151 23.344,16.715 22.807,16.715 Z",
                            "F1 M 22.807,13.372 L 17.413,13.372 C 16.875,13.372 16.440,13.808 16.440,14.346 C 16.440,14.883 16.875,15.319 17.413,15.319 L 22.807,15.319 C 23.345,15.319 23.780,14.883 23.780,14.346 C 23.780,13.808 23.344,13.372 22.807,13.372 Z",
                            "F1 M 22.807,6.686 L 17.413,6.686 C 16.875,6.686 16.440,7.122 16.440,7.660 C 16.440,8.197 16.875,8.633 17.413,8.633 L 22.807,8.633 C 23.345,8.633 23.780,8.197 23.780,7.660 C 23.780,7.122 23.344,6.686 22.807,6.686 Z",
                            "F1 M 22.807,10.029 L 17.413,10.029 C 16.875,10.029 16.440,10.465 16.440,11.003 C 16.440,11.540 16.875,11.976 17.413,11.976 L 22.807,11.976 C 23.345,11.976 23.780,11.540 23.780,11.003 C 23.780,10.465 23.344,10.029 22.807,10.029 Z",
                            "F1 M 22.807,20.023 L 17.413,20.023 C 16.875,20.023 16.440,20.459 16.440,20.997 C 16.440,21.535 16.875,21.970 17.413,21.970 L 22.807,21.970 C 23.345,21.970 23.780,21.535 23.780,20.997 C 23.780,20.459 23.344,20.023 22.807,20.023 Z",
                            "F1 M 31.026,16.715 L 25.633,16.715 C 25.095,16.715 24.659,17.151 24.659,17.689 C 24.659,18.226 25.095,18.662 25.633,18.662 L 31.026,18.662 C 31.564,18.662 32.000,18.226 32.000,17.689 C 32.000,17.151 31.564,16.715 31.026,16.715 Z",
                            "F1 M 31.026,20.023 L 25.633,20.023 C 25.095,20.023 24.659,20.459 24.659,20.997 C 24.659,21.535 25.095,21.970 25.633,21.970 L 31.026,21.970 C 31.564,21.970 32.000,21.535 32.000,20.997 C 32.000,20.459 31.564,20.023 31.026,20.023 Z",
                            "F1 M 6.367,23.268 L 0.974,23.268 C 0.436,23.268 0.000,23.704 0.000,24.242 C 0.000,24.780 0.436,25.215 0.974,25.215 L 6.367,25.215 C 6.905,25.215 7.341,24.780 7.341,24.242 C 7.341,23.704 6.905,23.268 6.367,23.268 Z",
                            "F1 M 14.587,23.268 L 9.193,23.268 C 8.656,23.268 8.220,23.704 8.220,24.242 C 8.220,24.780 8.656,25.215 9.193,25.215 L 14.587,25.215 C 15.125,25.215 15.561,24.780 15.561,24.242 C 15.561,23.704 15.125,23.268 14.587,23.268 Z",
                            "F1 M 22.807,23.268 L 17.413,23.268 C 16.875,23.268 16.440,23.704 16.440,24.242 C 16.440,24.780 16.875,25.215 17.413,25.215 L 22.807,25.215 C 23.345,25.215 23.780,24.780 23.780,24.242 C 23.780,23.704 23.344,23.268 22.807,23.268 Z",
                            "F1 M 31.026,23.268 L 25.633,23.268 C 25.095,23.268 24.659,23.704 24.659,24.242 C 24.659,24.780 25.095,25.215 25.633,25.215 L 31.026,25.215 C 31.564,25.215 32.000,24.780 32.000,24.242 C 32.000,23.704 31.564,23.268 31.026,23.268 Z",
                            "F1 M 31.026,13.372 L 25.633,13.372 C 25.095,13.372 24.659,13.808 24.659,14.346 C 24.659,14.883 25.095,15.319 25.633,15.319 L 31.026,15.319 C 31.564,15.319 32.000,14.883 32.000,14.346 C 32.000,13.808 31.564,13.372 31.026,13.372 Z",
                            "F1 M 31.026,6.686 L 25.633,6.686 C 25.095,6.686 24.659,7.122 24.659,7.660 C 24.659,8.197 25.095,8.633 25.633,8.633 L 31.026,8.633 C 31.564,8.633 32.000,8.197 32.000,7.660 C 32.000,7.122 31.564,6.686 31.026,6.686 Z",
                            "F1 M 25.633,5.290 L 31.027,5.290 C 31.564,5.290 32.000,4.854 32.000,4.316 C 32.000,3.779 31.564,3.343 31.027,3.343 L 25.633,3.343 C 25.095,3.343 24.659,3.779 24.659,4.316 C 24.659,4.854 25.095,5.290 25.633,5.290 Z",
                            "F1 M 31.026,10.029 L 25.633,10.029 C 25.095,10.029 24.659,10.465 24.659,11.003 C 24.659,11.540 25.095,11.976 25.633,11.976 L 31.026,11.976 C 31.564,11.976 32.000,11.540 32.000,11.003 C 32.000,10.465 31.564,10.029 31.026,10.029 Z"
                        };
                        _thumbnail = new GeometryGroup();
                        foreach (var value in values)
                        {
                            _thumbnail.Children.Add(Geometry.Parse(value));
                        }
                        _thumbnail.Freeze();
                    }
                    return _thumbnail;
                }
            }

            public void Refresh()
            {
                if (_advancedAudioVisualisation != null) _advancedAudioVisualisation.Dispose();
                if (_smartWindowAudioVisualisation != null) _smartWindowAudioVisualisation.Disable();

                _advancedAudioVisualisation = null;
                _smartWindowAudioVisualisation = null;
            }
        }
    }
}